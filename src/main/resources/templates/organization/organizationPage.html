<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:th="http://www.thymeleaf.org">
<head th:include="_header_include::frag(~{::title},~{},~{})">
    <title>组织机构管理</title>
    <style>
        .organizationManage .leftBox{/*width: 200px;*/height: auto;border:1px solid #ebeef5;min-height: 480px;}
        .organizationManage .leftTitle{background:#ebeef5;text-indent: 20px;height: 40px;line-height: 40px;}
        .organizationManage .leftTree{padding:10px;}
        .organizationManage .rightTitle{background:#ebeef5;text-indent: 20px;height: 40px;line-height: 40px;}
    </style>
</head>
<body>
<div id="organizationManage" class="organizationManage mainPadding">  
    <el-breadcrumb separator="/" class="elBreadcrumb marginB20">
        <el-breadcrumb-item>Home</el-breadcrumb-item>
        <el-breadcrumb-item>系统管理</el-breadcrumb-item>
        <el-breadcrumb-item><a href="JavaScript:void(0)" data-url="b.html">组织机构管理</a></el-breadcrumb-item>
    </el-breadcrumb>
    <el-row :gutter="20">
        <el-col :xs="12" :sm="7" :md="5" :lg="3" :xl="3">
            <div class="leftBox">
                <div class="leftTitle fs16">组织机构列表</div>
                <el-tree
                    :data="dataTree"              
                    node-key="id"
                    :default-expanded-keys="[1,2,3]"
                    ref="tree"
                    highlight-current
                    class="leftTree">
                </el-tree>
            </div>            
        </el-col>
        <el-col :xs="12" :sm="17" :md="19" :lg="21" :xl="21">
            <el-row class="marginB10">
                <el-col :xs="12" :sm="16" :md="16" :lg="18" :xl="12">
                    <el-button type="primary" @click="dialogFormVisible = true"><i class="el-icon-plus"></i> 添加下一级组织</el-button>
                    <el-button type="primary">修改</el-button>
                    <el-button type="primary" @click="deleteFun">删除</el-button>
                </el-col>
                <el-col :xs="12" :sm="8" :md="8" :lg="6" :xl="12">
                    <el-input placeholder="按照组织名称进行查询" class="input-with-select">                        
                    <el-button slot="append" icon="el-icon-search"></el-button>
                    </el-input>
                </el-col>
            </el-row>
            <el-row class="rightTitle fs16">“父级名称” 下一级组织</el-row>
            <el-row>
                <el-table 
                    ref="multipleTable"
                    tooltip-effect="dark"
                    style="width: 100%"
                    @selection-change="handleSelectionChange"
                    border
                    :data="dataTable" 
                    >
                    <el-table-column align="center" type="selection" width="55"></el-table-column>
                    <!-- <el-table-column prop="date" label="全选" width="180"></el-table-column> -->
                    <el-table-column align="center" prop="name" label="组织名称"></el-table-column>
                    <el-table-column align="center" prop="number" label="组内成员（人）"></el-table-column>
                    <el-table-column align="center" prop="remarks" label="备注"></el-table-column>
                </el-table>
            </el-row>
        </el-col>
    </el-row>
    <!-- dialog -->
    <el-dialog title="添加下级组织" :visible.sync="dialogFormVisible">
        <el-form :model="form">
            <el-form-item label="上级组织：" :label-width="formLabelWidth">
                推广中心
            </el-form-item>
            <el-form-item label="组织名称：" :label-width="formLabelWidth">
                <el-input v-model="form.name" autocomplete="off"></el-input>
            </el-form-item>
            <el-form-item label="组织备注：" :label-width="formLabelWidth">
                <el-input
                      type="textarea"
                      :rows="4"
                      placeholder="填写备注信息"
                      v-model="form.remark">
                </el-input>
                <p>200字</p>
            </el-form-item>
        </el-form>
        <div slot="footer" class="dialog-footer">
            <el-button @click="dialogFormVisible = false">取 消</el-button>
            <el-button type="primary" @click="dialogFormVisible = false">确 定</el-button>
        </div>
    </el-dialog>
</div>
</body>
<!-- import common js-->
<div th:include="_footer_include :: #jsLib"></div>
<script>
    new Vue({
        el: '#organizationManage',
        data: function() {
            return {
                dataTree: [{
                    id: 0,
                    label: '根目录',
                    children: [{
                        id: 1,
                        label: '推广中心',
                        children: [{
                            id: 4,
                            label: '推广客服',
                            children: [{
                                id: 9,
                                label: '客服一组'
                            }, {
                                id: 10,
                                label: '客服二组'
                            }]
                        }]
                        }, {
                        id: 2,
                        label: '招商中心',
                        children: [{
                            id: 5,
                            label: '秦皇岛招商中心'
                        }, {
                            id: 6,
                            label: '石家庄招商中心'
                        }]
                        }, {
                        id: 3,
                        label: '商务中心',
                        children: [{
                            id: 7,
                            label: '商务一'
                        }, {
                            id: 8,
                            label: '商务二'
                        }]
                    }]
                }],
                dataTable: [{
                    date: '2016-05-02',
                    name: '王小虎1',
                    number:'29',
                    remarks:'暂无'
                    }, {
                        date: '2016-05-04',
                        name: '王小虎2',
                        number:'30',
                        remarks:'暂无'
                    }, {
                        date: '2016-05-01',
                        name: '王小虎3',
                        number:'31',
                        remarks:'暂无'
                    }, {
                        date: '2016-05-03',
                        name: '王小虎4',
                        number:'32',
                        remarks:'暂无'
                }],
                multipleSelection: [],
                dialogFormVisible: false,
                form: {
                    name: '',
                    remark: '',
                    delivery: false,
                    type: []
                },
                formLabelWidth: '120px'
            }             
        },
        methods: {
            toggleSelection(rows) {
                if (rows) {
                    rows.forEach(row => {
                        this.$refs.multipleTable.toggleRowSelection(row);
                    });
                } else {
                  this.$refs.multipleTable.clearSelection();
                }
            },
            handleSelectionChange(val) {
                this.multipleSelection = val;
            },
            deleteFun() {
                this.$alert('删除后此组织信息将不存在，确认删除吗？', '消息提醒', {
                    confirmButtonText: '确定',
                    callback: action => {
                        this.$message({
                            type: 'info',
                            message: `action: ${ action }`
                        });
                    }
                });
            }
        }
    })
</script>
</html>