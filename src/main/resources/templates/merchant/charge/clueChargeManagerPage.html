<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head th:replace="_header_include::frag(~{::title},~{},~{})">
    <title>后台管理系统</title>
    <style>
        button a{color:#fff!important;}
    </style>
</head>
<body>
<div id="clueChargeManage" class="clueChargeManage mainPadding" style="display: none;">  
    <el-breadcrumb separator="/" class="elBreadcrumb marginB20">
        <el-breadcrumb-item>Home</el-breadcrumb-item>
        <el-breadcrumb-item>费用设置</el-breadcrumb-item>
        <el-breadcrumb-item>资源资费设置</el-breadcrumb-item>
    </el-breadcrumb>    
    <el-row>
      <el-col :span="12" style="text-align: right;">
        <el-form :inline="true" :model="clueChargeSearchForm" class="demo-form-inline" ref="clueChargeSearchForm">               
          <el-form-item label="资源类别:">
                    <el-select v-model="clueChargeSearchForm.category" filterable  clearable placeholder="选择资源类别">
                        <el-option
                            v-for="item in categoryOptions"
                            :key="item.value"
                            :label="item.name"
                            :value="item.value">
                        </el-option>
                    </el-select>
                </el-form-item>
          <el-form-item label=""> 
              <el-button icon="el-icon-search" type="primary" @click="searchTable()">搜索</el-button>
          </el-form-item>    
        </el-form>
      </el-col>
	</el-row>
	  <div class="mainSearchBg">
      <el-row>
          <el-table  ref="multipleTable" tooltip-effect="dark" border 
              style="width: 100%"  :data="dataTable" >
              <el-table-column align="center" type="index" label="序号" width="55"></el-table-column>
              <el-table-column align="center" prop="categoryName" label="资源类别"></el-table-column>
              <el-table-column align="center" prop="charge" label="价格（元）/条"></el-table-column>
              <el-table-column align="center" prop="updateTime" label="更新时间" :formatter="dateFormat" ></el-table-column>
             <el-table-column align="center" prop="updateUserName" label="操作人员" ></el-table-column>
              <el-table-column align="center" prop="" label="操作"></el-table-column>
          </el-table>
      </el-row>
    </div>
</div>
<!-- import common js-->
<div th:include="_footer_include :: #jsLib"></div>
</body>
<script th:inline="javascript">
var categoryList=[[${categoryList}]];//资费类别
var clueChargeVM = new Vue({
        el: '#clueChargeManage',
        data: {
        		clueChargeSearchForm: {
	        		category: ''
	            },
	            dataTable:[],
	            dialogFormVisible: false,
	            submitDisabled: false,
	            multipleSelection:[],
	            categoryOptions:categoryList,
                formLabelWidth: '150px',
                formLabelWidth1: '120px',
        },
        methods: {
        	searchTable() {
                var param ={};
                param.category = this.clueChargeSearchForm.category;
                console.info(param);
                axios.post('/merchant/clueChargeManager/listNoPage', param)
                .then(function (response) {
                      var result =  response.data;
                      console.info(result);
                      clueChargeVM.dataTable= result.data;
                })
                .catch(function (error) {
                     console.log(error);
                });
                
              },
              //选择行
              handleSelectionChange(val) {
                  this.multipleSelection = val;
              },
            //日期数据格式化方法
              dateFormat( row, column, cellValue, index) {
                if (cellValue == undefined) {
                   return "";
                }
                return moment(cellValue).format("YYYY-MM-DD HH:mm:ss");
              },
        },
        created(){
            // 取页数存储
            var localVal=localStorage.getItem('allChangePageSize')?parseInt(localStorage.getItem('allChangePageSize')):'';
            if(localVal){this.pager.pageSize = localVal;}
            
            console.info("create method");
            this.searchTable();
           
        },
        mounted(){
           console.info("mounted method");
           document.getElementById('clueChargeManage').style.display = 'block';
        }
    })
    
</script>
</html>