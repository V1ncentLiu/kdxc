<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:th="http://www.thymeleaf.org">
<head th:include="_header_include::frag(~{::title},~{},~{})">
	<title>角色列表</title>
    <style>
        button a{color:#fff!important;}
    </style>
</head>
<body>
<div id="roleManage" class="mainPadding">  
    <el-breadcrumb separator="/" class="elBreadcrumb marginB20">
        <el-breadcrumb-item>Home</el-breadcrumb-item>
        <el-breadcrumb-item>系统管理</el-breadcrumb-item>
        <el-breadcrumb-item><a href="JavaScript:void(0)" data-url="roleManagePage.html">角色管理</a></el-breadcrumb-item>
    </el-breadcrumb>
    <el-row class="marginB10">
        <el-col :xs="12" :sm="16" :md="16" :lg="18" :xl="12">
            <el-button type="primary"><a href="/role/roleManager/addRolePre"><i class="el-icon-plus"></i> 添加</a></el-button>
            <el-button type="primary">修改</el-button>
            <el-button type="primary" @click="deleteFun">删除</el-button>
        </el-col>
        <el-col :xs="12" :sm="8" :md="8" :lg="6" :xl="12">
            <el-input  v-model="roleListQuery.roleName" placeholder="请输入角色名称" class="input-with-select">                        
            <el-button slot="append" @click="queryRoleDataList" icon="el-icon-search">搜索</el-button>
            </el-input>
        </el-col>
    </el-row>
    <el-row>
        <el-table 
            ref="multipleTable"
            tooltip-effect="dark"
            style="width: 100%"
            @selection-change="handleSelectionChange"
            border
            :data="dataTable" 
            >
            <el-table-column align="center" prop="id" type="selection" width="55"></el-table-column>
            <el-table-column align="center" prop="name" label="角色名称"></el-table-column>
            <el-table-column align="center" prop="userCount" label="角色成员（人）">
                <template slot-scope="scope">
                    <span class="bluecolor cursorP" @click="dialogFormVisible = true">{{ scope.row.number }}</span>
                </template>
            </el-table-column>
        </el-table>
    </el-row>
    <!-- dialog -->
    <el-dialog title="角色内成员" :visible.sync="dialogFormVisible">
        <el-form :model="form">
            <el-row class="marginB10 greybg padding20">
                <el-row :gutter="20">
                    <el-col :span="6">
                        <el-input v-model="searchInput" placeholder="姓名"></el-input>
                    </el-col>
                    <el-col :span="6">
                        <el-input v-model="searchInput" placeholder="登录名"></el-input>
                    </el-col>
                    <el-col :span="6">
                        <el-input v-model="searchInput" placeholder="手机号"></el-input>
                    </el-col>
                    <el-col :span="2">
                        <el-button type="primary" size="medium"  @click="queryRoleDataList" icon="el-icon-search">搜索</el-button>
                    </el-col>
                </el-row>
            </el-row>
            <el-table 
                tooltip-effect="dark"
                style="width: 100%"
                border
                :data="dataTableRole" 
                class="marginB10">
                <el-table-column align="center" prop="num" label="序号" width="55"></el-table-column>
                <el-table-column align="center" prop="name" label="姓名"></el-table-column>
                <el-table-column align="center" prop="userName" label="登录名"></el-table-column>
                <el-table-column align="center" prop="phone" label="手机号"></el-table-column>
                <el-table-column align="center" prop="org" label="所属组织"></el-table-column>
            </el-table>
            <el-pagination
                @size-change="handleSizeChange"
                @current-change="handleCurrentChange"
                :current-page="currentPage"
                :page-sizes="[10, 20, 30, 40]"
                :page-size="10"
                layout="total, sizes, prev, pager, next, jumper"
                :total="40">
            </el-pagination>
        </el-form>
        
    </el-dialog>
</div>
</body>
<div th:include="_footer_include :: #jsLib"></div>
<script>
var roleListVM =new Vue({
        el: '#roleManage',
        data: function() {
            return {
                searchInput:'',
                dataTableRole: [
                    {
                        num:'1',
                        name:'推广管理',
                        userName:'一级',
                        phone:'15140361111',
                        org:'组织1'
                    }, {
                        num:'2',
                        name:'推广管理2',
                        userName:'一级',
                        phone:'15140361112',
                        org:'组织2'
                    }, {
                        num:'3',
                        name:'推广管理3',
                        userName:'一级',
                        phone:'15140361113',
                        org:'组织1'
                    }, {
                        num:'4',
                        name:'推广管理4',
                        userName:'一级',
                        phone:'15140361114',
                        org:'组织1'
                }],
                roleListQuery:{
                	roleName:'',
                },
                dataTable: [],
                multipleSelection: [],
                dialogFormVisible: false,
                form: {
                    name: '',
                    remark: '',
                    delivery: false,
                    type: []
                },
                formLabelWidth: '120px',
                currentPage: 1//默认第一页
            }             
        },
        methods: {
            handleClick(row) {
                console.log(row);
            },
            handleSelectionChange(val) {
                this.multipleSelection = val;
            },	
             queryRoleDataList(){//查询按钮
            	 var param = this.roleListQuery;
                  axios.post('/role/roleManager/queryRoleList',param).then(function (response) {
                    if(null===response||response.data==null||response.data.code!='0'){
                          alert(response.data.message);
                        return ;
                    }else{
                      roleListVM.dataTable =response.data.data; 
                    }
                  })
                  .catch(function (error) {
                    console.log(error);
                  })
                  .then(function () {
                  });  
                  
              },
            // 删除
            deleteFun() {
                this.$confirm('删除后此角色信息将不存在，确认删除吗？', '消息提醒', {
                    confirmButtonText: '确定',
                    cancelButtonText: '取消',
                    type: 'warning'
                }).then(() => {
                    this.$message({
                        type: 'success',
                        message: '删除成功!'
                    });
                }).catch(() => {
                    this.$message({
                        type: 'info',
                        message: '已取消删除'
                    });          
                });
            },
            // 分页
            handleSizeChange(val) {
                console.log(`每页 ${val} 条`);
            },
            handleCurrentChange(val) {
                console.log(`当前页: ${val}`);
            }
         },
         created(){
       	 //初始化数据列表
        	this.queryRoleDataList();
         },
        mounted(){
       	  
        }
        
    })
</script>
</html>