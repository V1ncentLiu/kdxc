<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro">
<head th:replace="_header_include::frag(~{::title},~{},~{})">
    <title>后台管理系统</title>
</head>
<body>
<div id="maindiv" class="maindiv mainPadding" style="display: none;">    
    <el-breadcrumb separator="/" class="elBreadcrumb marginB20">
        <el-breadcrumb-item>Home</el-breadcrumb-item>
        <el-breadcrumb-item>业务设置</el-breadcrumb-item>        
        <el-breadcrumb-item>IM授权设置</el-breadcrumb-item>
    </el-breadcrumb>  
    <div class="mainSearchBg"> 
        <el-form :model="form" :rules="rules" ref="form">       
            <div class="mainSearchFormBox">
                <el-form-item label="每日接待IM客户上限:"> 
                    <el-input v-model="form.dayReceiveMax" placeholder="" style="width: 100px;margin-right: 10px;"></el-input>人
                </el-form-item> 
                <el-form-item label="服务品牌选择:"> 
                    <el-button  @click="open" type="danger"  size="small">添加服务品牌</el-button>
                    <el-button  @click="settingAll" type="text"  size="small">设定全部品牌</el-button>
                </el-form-item>
            </div>
            已选服务品牌
             <el-row>
                <el-table 
                    ref="tableData"
                    tooltip-effect="dark"
                    style="width: 100%"
                    border
                    :data="form.tableData"
                    v-loading="loading">
                    <el-table-column type="index" label="序号" align="center" width="55"></el-table-column>
                    <el-table-column prop="projectName" align="center" label="品牌名称">
                    </el-table-column>
                    <el-table-column prop="category" align="center" label="品牌分类" width="80">
                    </el-table-column>
                    <el-table-column prop="groupName" align="center" label="品牌分类" width="80">
                    </el-table-column>
                    <el-table-column prop="" align="center" label="操作">
                        <template slot-scope="scope">
                            <el-button @click.native.prevent="delete(scope.$index, form.tableData)" type="text" size="small">删除</el-button>
                        </template>
                    </el-table-column>
                </el-table>
            </el-row>
            <div class="padding20 f-tac"> 
                <el-button  @click="submit" type="primary"  size="small">确定</el-button>
                <el-button  @click="cancel" type="warning"  size="small">取消</el-button>
                <el-button  @click="goback" type="success"  size="small">返回身份列表</el-button>
            </div>  
        </el-form> 
    </div>     
</div>
<!-- import common js-->
<div th:include="_footer_include :: #jsLib"></div>
</body>
<script th:inline="javascript">
    // 已选品牌集合 brandList
    // 所有品牌集合 allBrandList
    // 项目分类字典  categoryList
    // 所属公司       userInfoList
    // 授权信息 saleIm {
    //         "id":"",
    //         "teleSaleId",""                        //电销顾问id
    //         "dayReceiveMax":"",            //每日上限数
    //         "brandIdList":[]                    //已选品牌列dList
    // }
    var brandList=[[${brandList}]]; 
    var allBrandList = [[${allBrandList}]];
    var categoryList = [[${categoryList}]];
    var userInfoList = [[${userInfoList}]];
    var saleIm = [[${saleIm}]];
    console.log(brandList)
    console.log(allBrandList)
    console.log(categoryList)
    console.log(userInfoList)
    console.log(saleIm)
    var mainDivVM = new Vue({
        el: '#maindiv',
        data: function() {
            return {
                loading: false,
                isDisabled: false,
                form: {
                    dayReceiveMax:'',
                    tableData:[]
                },
                tableDataDialog: [],
                rules:{}
            }             
        },
        methods: {   
            open(){

            },
            settingAll  (){

            },
            submit(){

            },
            cancel(){

            },
            goback(){

            }, 
            delete(index, rows) {//删除一行表格
                debugger
                rows.splice(index, 1);
            },
            searchTable(firstPage) {                 
                var param = {};
                param.pageNum = this.pager.currentPage
                param.pageSize = this.pager.pageSize; 
                this.loading = true; 
                axios.post('/custservice/saleIm/list',param).then(function (response) { 
                   mainDivVM.loading = false;
                   console.log(response)
                   var result =  response.data;
                    if(result.code==0){
                        var table=result.data;
                        mainDivVM.tableData= table.data;
                        mainDivVM.pager.total =  table.total;
                        mainDivVM.pager.currentPage = table.currentPage;
                    }else{
                        mainDivVM.isDisabled=false;
                        mainDivVM.$message.error(result.msg);
                    }  
                }).catch(function (error) {
                    mainDivVM.loading = false;
                    mainDivVM.$message({
                        message: "请求失败，请稍后重试",
                        type: "error"
                    });
                });
            },
           
        },
        created(){  
            this.form.tableData=allBrandList;
        },
        mounted(){
            document.getElementById('maindiv').style.display = 'block';
        }
    })
    
</script>
</html>